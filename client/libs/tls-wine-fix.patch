diff --git a/src/cTlsSocket.cls b/src/cTlsSocket.cls
index 071f395..fc65c34 100644
--- a/src/cTlsSocket.cls
+++ b/src/cTlsSocket.cls
@@ -350,7 +350,7 @@ Private Type CERT_CHAIN_ENGINE_CONFIG
     '--- following are Win7+ only
     hExclusiveRoot      As Long
     hExclusiveTrustedPeople As Long
-    dwExclusiveFlags    As Long
+    'dwExclusiveFlags    As Long
 End Type
 
 Private Type CERT_CHAIN_ELEMENT
@@ -2839,7 +2839,7 @@ Private Function pvPkiCertBuildChain(ByVal pCertContext As Long, ByVal hCertStor
     
     On Error GoTo EH
     '--- build custom chain engine that trusts the additional stores if provided
-    uEngineConfig.cbSize = LenB(uEngineConfig) - IIf(OsVersion < ucsOsvWin8, 12, 0)
+    uEngineConfig.cbSize = LenB(uEngineConfig) - IIf(OsVersion < ucsOsvWin8, 8, 0)
     If hCertStore <> 0 Then
         hStores(lIdx) = hCertStore: lIdx = lIdx + 1
     End If
